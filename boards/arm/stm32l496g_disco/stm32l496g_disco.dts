/*
 * Copyright (c) 2017 Linaro Limited
 *
 * SPDX-License-Identifier: Apache-2.0
 */

/dts-v1/;
#include <st/l4/stm32l496Xg.dtsi>

/ {
	model = "STMicroelectronics STM32L496G-DISCO board";
	compatible = "st,stm32l496g-disco", "st,stm32l496";

	chosen {
		zephyr,console = &usart2;
		zephyr,shell-uart = &usart2;
		zephyr,sram = &sram0;
		zephyr,flash = &flash0;
	};

	leds {
		compatible = "gpio-leds";
		green_led_2: led_2 {
			gpios = <&gpiob 13 GPIO_ACTIVE_LOW>;
			label = "User LD2";
		};
	};

	gpio_keys {
		compatible = "gpio-keys";
		joy_sel: joystick_select {
			label = "joystick select";
			gpios = <&gpioc 13 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
		};
		joy_down: joystick_down {
			label = "joystick down";
			gpios = <&gpioi 10 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
		};
		joy_up: joystick_up {
			label = "joystick up";
			gpios = <&gpioi 8 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
		};
		joy_left: joystick_left {
			label = "joystick left";
			gpios = <&gpioi 9 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
		};
		joy_right: joystick_right {
			label = "joystick right";
			gpios = <&gpiof 11 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>;
		};

	};

	aliases {
		led0 = &green_led_2;
		sw0 = &joy_sel;
		sw1 = &joy_up;
		sw2 = &joy_down;
		sw3 = &joy_left;
		sw4 = &joy_right;

		i2c2 = &i2c2;
		usart2 = &usart2;
	};

	arduino_header: connector {
		compatible = "arduino-header-r3";
		
		#gpio-cells = <2>;
		
		gpio-map-mask = <0xffffffff 0xffffffc0>;
		gpio-map-pass-thru = <0 0x3f>;
		gpio-map = 
			   <0 0 &gpioc 4 0>,    // A0
			   <1 0 &gpioc 1 0>,    // A1 
			   <2 0 &gpioc 3 0>,    // A2 
			   <3 0 &gpiof 10 0>,   // A3 
			   <4 0 &gpioa 1 0>,    // A4 
			   <5 0 &gpioc 0 0>,    // A5 
			   <6 0 &gpiog 8 0>,    // D0 ; Also Arduino's LPUART
			   <7 0 &gpiog 7 0>,    // D1 ; Also Arduino's LPUART
			   <8 0 &gpiog 13 0>,   // D2 
			   <9 0 &gpioh 15 0>,   // D3 
			   <10 0 &gpioi 11 0>,  // D4 
			   <11 0 &gpiob 9 0>,   // D5 
			   <12 0 &gpioi 6 0>,   // D6 
			   <13 0 &gpiog 6 0>,   // D7 
			   <14 0 &gpiog 15 0>,  // D8 
			   <15 0 &gpioh 13 0>,  // D9 
			   <16 0 &gpioa 15 0>,  // D10 ; Also Arduino's SPI
			   <17 0 &gpiob 5 0>,   // D11 ; Also Arduino's SPI
			   <18 0 &gpiob 4 0>,   // D12 ; Also Arduino's SPI
			   <19 0 &gpioa 5 0>,   // D13 ; Also Arduino's SPI
			   <20 0 &gpiob 7 0>,   // D14 ; Also Arduino's I2C
			   <21 0 &gpiob 8 0>;   // D15 ; Also Arduino's I2C
	};
	
};


arduino_i2c: &i2c1 {};              // Arduino's I2C is linked to I2C_1
arduino_spi: &spi1 {};              // Arduino's SPI is linked to SPI_1
arduino_serial: &lpuart1 {};        // Arduino's UART is linked to LPUART_1

stmod_usart: &usart1 {};            // The STMOD are using UART_1

&arduino_header{
	status = "okay";
};

&usart1 {
	current-speed = <115200>;
	status = "okay";
};

&usart2 {
	current-speed = <115200>;
	status = "okay";
};

&lpuart1 {
	current-speed = <115200>;
	status = "okay";
};

&timers2 {
	status = "okay";

	pwm2: pwm {
		status = "okay";
	};
};

&i2c1 {
	status = "okay";
	clock-frequency = <I2C_BITRATE_FAST>;
};

&i2c2 {
	status = "okay";
	clock-frequency = <I2C_BITRATE_FAST>;
};

&spi1 {
	status = "okay";
};

&rtc {
	status = "okay";
};

&sdmmc1 {
	status = "okay";
};

&usbotg_fs {
	status = "okay";
};
